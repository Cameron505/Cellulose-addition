#quick look at the mesic 10 cm soil temp data
ggplot(data=mesic.met.station.daily)+
geom_line(aes(x=Date, y=Control_10.mean))+
ylab("Soil Temperature at 10 cm Depth (deg C)")+
ggtitle("Mesic")
#add columns for year and month
mesic.met.station.daily$YEAR <- year(mesic.met.station.daily$Date)
mesic.met.station.daily$MONTH <- month(mesic.met.station.daily$Date)
#calculate monthly means
mesic.met.station.monthly <- summary_by(data=mesic.met.station.daily, Control_10.mean~YEAR+MONTH, FUN=c(length2, mean))
#grab only complete months
mesic.met.station.monthly <- subset(mesic.met.station.monthly, Control_10.mean.length2>27)
#merge monthly mesic 10 cm soil temps with Kotz long-term air temp record
mesic.soil.kotz.air <- merge(mesic.met.station.monthly, kotz.monthly.air.temp, by=c("YEAR", "MONTH"))
#plots of mesic 10 cm soil versus Kotz air temp
ggplot(data=mesic.soil.kotz.air, aes(x=TAVG.mean, y=Control_10.mean.mean, color=MONTH))+
geom_point()+
ylab("Soil Temperature at 10 cm Depth (deg C)")+
xlab("Kotzebue Air Temperature (deg C)")+
ggtitle("Mesic")
#mesic models
mesic.summer.model <- lm(data=subset(mesic.soil.kotz.air, TAVG.mean>=5), Control_10.mean.mean~TAVG.mean)
summary(mesic.summer.model)
mesic.winter.model <- lm(data=subset(mesic.soil.kotz.air, TAVG.mean<5), Control_10.mean.mean~TAVG.mean)
summary(mesic.winter.model)
##XERIC MET STATION DATA##
xeric.met.station <- read.csv("data/Temp/Xeric Met Station.csv")
#read date as such
xeric.met.station$Date <- as.Date(xeric.met.station$Date)
#calculate daily means
xeric.met.station.daily <- summary_by(data=xeric.met.station, Control_10~Date, FUN=c(length2, mean), na.rm=TRUE)
#quick look at the xeric 10 cm soil temp data
ggplot(data=xeric.met.station.daily)+
geom_line(aes(x=Date, y=Control_10.mean))+
ylab("Soil Temperature at 10 cm Depth (deg C)")+
ggtitle("Xeric")
#add columns for year and month
xeric.met.station.daily$YEAR <- year(xeric.met.station.daily$Date)
xeric.met.station.daily$MONTH <- month(xeric.met.station.daily$Date)
#calculate monthly means
xeric.met.station.monthly <- summary_by(data=xeric.met.station.daily, Control_10.mean~YEAR+MONTH, FUN=c(length2, mean))
#grab only complete months
xeric.met.station.monthly <- subset(xeric.met.station.monthly, Control_10.mean.length2>27)
#merge monthly xeric 10 cm soil temps with Kotz long-term air temp record
xeric.soil.kotz.air <- merge(xeric.met.station.monthly, kotz.monthly.air.temp, by=c("YEAR", "MONTH"))
#plots of xeric 10 cm soil versus Kotz air temp
ggplot(data=xeric.soil.kotz.air, aes(x=TAVG.mean, y=Control_10.mean.mean, color=MONTH))+
geom_point()+
ylab("Soil Temperature at 10 cm Depth (deg C)")+
xlab("Kotzebue Air Temperature (deg C)")+
ggtitle("Xeric")
#xeric models
xeric.summer.model <- lm(data=subset(xeric.soil.kotz.air, TAVG.mean>=5), Control_10.mean.mean~TAVG.mean)
summary(xeric.summer.model)
xeric.winter.model <- lm(data=subset(xeric.soil.kotz.air, TAVG.mean<5), Control_10.mean.mean~TAVG.mean)
summary(xeric.winter.model)
#add soil temperature predictions to Kotz air temperature dataframe
kotz.monthly.air.temp$Xeric.Soil <- ifelse(kotz.monthly.air.temp$TAVG.mean>=5, predict(xeric.summer.model, kotz.monthly.air.temp),
predict(xeric.winter.model, kotz.monthly.air.temp))
kotz.monthly.air.temp$Mesic.Soil <- ifelse(kotz.monthly.air.temp$TAVG.mean>=5, predict(mesic.summer.model, kotz.monthly.air.temp),
predict(mesic.winter.model, kotz.monthly.air.temp))
kotz.monthly.air.temp$Hydric.Soil <- ifelse(kotz.monthly.air.temp$TAVG.mean>=5, predict(hydric.summer.model, kotz.monthly.air.temp),
predict(hydric.winter.model, kotz.monthly.air.temp))
#plots of three sites temperatures
EZ<- melt(kotz.monthly.air.temp, id.vars=c("YEAR","MONTH","TAVG.length2"))
EZ2<- EZ%>%
mutate(decade = floor(YEAR/10)*10) %>%
group_by(MONTH, decade, variable)
EZ2$decade<- as.character(EZ2$decade)
EZ3 = EZ2 %>%
filter(variable== "Xeric.Soil" | variable== "Mesic.Soil" |variable== "Hydric.Soil", decade >= 1950) %>%
mutate(MONTH2 = month.abb[MONTH])
EZ3$MONTH2<-factor(EZ3$MONTH2, levels = month.abb)
ET<-ggplot(EZ3, aes(x=MONTH2, y=value, fill=decade))+
geom_bar(stat='identity',position='dodge')+
ylab(expression(paste("10 cm estimated Soil Temp.(",degree,C,')')))+
xlab("Month")+
ggtitle("")+
scale_fill_manual(values=cbPalette)+
ggtitle("Historic soil temperature estimates")+
guides(fill=guide_legend(title="Decade"))+
geom_hline(yintercept=10, linetype="dashed", color = "red", size=1)+
geom_hline(yintercept=6, linetype="dashed", color = "red", size=1)+
geom_hline(yintercept=2, linetype="dashed", color = "red", size=1)+
geom_hline(yintercept=-2, linetype="dashed", color = "red", size=1)+
geom_hline(yintercept=-6, linetype="dashed", color = "red", size=1)+
geom_hline(yintercept=-10, linetype="dashed", color = "red", size=1)+
theme_CKM()
EZ = read.csv("Data/Enzyme.csv")
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZERROR,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_kp()
ggplot(EZERROR,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_CKM()
EZCARBON = EZERROR %>%
filter(variable== "BG" | variable== "BX" |variable== "EndoC" |variable== "EndoX")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_CKM()
# custom ggplot theme
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_CKM()
ggsave("Graphs/Carbon_Enzymes.png")
=======
#TAVG estimated as mean of TMIN and TMAX for consistency throughout record
kotz.daily.air.temp <- read.csv("data/Temp/kotz.daily.air.temp.1900.2019.csv")
kotz.daily.air.temp$DATE <- as.Date(kotz.daily.air.temp$DATE)
>>>>>>> Stashed changes
source("code/0-packages.R")
EZ = read.csv("Data/Enzyme.csv")
EZ$CN<-EZ$BG/(EZ$LAP+EZ$NAG)
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
##### Without additions
EZERROR2 = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZERROR2,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_CKM()
detach("package:dplyr", unload = TRUE)
library(dplyr)
ggplot(EZERROR2,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_CKM()
##### Without additions
EZERROR2 = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZERROR2,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_CKM()
EZNUT = EZERROR2 %>%
filter(variable== "LAP" | variable== "NAG" |variable== "PHOS" |variable== "AFS")
ggplot(EZNUT,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_CKM()
View(EZNUT)
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_CKM()
ANOVLAP =
adonis(EZ %>% dplyr::select(LAP)~ Add * Temp , data = EZ)
ANOVNAG =
adonis(EZ %>% dplyr::select(NAG)~ Add * Temp , data = EZ)
ANOVNAG
EZCN = EZERROR2 %>%
filter(variable== "CN")
ggplot(EZCN,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("BG/(LAP+NAG)")+
theme_CKM()
EZCBH = EZERROR2 %>%
filter(variable== "CBH")
ggplot(EZCBH,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_CKM()
##### With additions
EZERROR2 = EZ2 %>%
group_by(Temp, variable, Add) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
EZCARBON = EZERROR2 %>%
filter(variable== "BG" | variable== "BX" |variable== "EndoC" |variable== "EndoX")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Add))+
geom_bar(stat = "identity", position="dodge")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_CKM()
EZCBH = EZERROR2 %>%
filter(variable== "CBH")
ggplot(EZCBH,aes(x = Temp, y = mean_value, fill=Add))+
geom_bar(stat = "identity", position="dodge")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_CKM()
ggplot(EZCBH,aes(x = Temp, y = mean_value, fill=Add))+
geom_bar(stat = "identity", position="dodge")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
facet_wrap(~ variable, ncol = 2,scales = "free")
EZ = read.csv("Data/Enzyme.csv")
EZ$CN<-EZ$BG/(EZ$LAP+EZ$NAG)
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
source("code/0-packages.R")
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZ$alpha <- (EZ$EndoC+EZ$EndoX)/(EZ$EndoC+EZ$EndoX+EZ$BG+EZ$BX)
EZ$Temp[EZ$Temp=="4"]<-"Pre"
EZ$Temp<- factor(EZ$Temp, levels= c("-6","-2","2","6","10","Pre"))
ggplot(EZ,aes(x = Temp, y = alpha, fill=Add))+
geom_bar(stat = "identity", position="dodge")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")+
theme_CKM()
ggplot(EZ,aes(x = Temp, y = alpha, fill=Add))+
geom_bar(stat = "identity", position="dodge")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")+
theme_CKM()
ggplot(EZ,aes(x = Temp, y = alpha, fill=Add))+
geom_bar(stat = "identity", position="dodge")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")+
theme_CKM()
ggplot(EZ,aes(x = Temp, y = alpha))+
geom_bar(stat = "identity", position="dodge")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")+
theme_CKM()
ggplot(EZ,aes(x = Temp, y = alpha))+
geom_point(stat = "identity", position="dodge")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")+
theme_CKM()
ggplot(EZ,aes(x = Temp, y = alpha))+
geom_point(stat = "mean", position="dodge")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")+
theme_CKM()
ggplot(EZ,aes(x = Temp, y = alpha, color=Add))+
geom_point(stat = "mean", position="dodge")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")
ggplot(EZ,aes(x = Temp, y = alpha, color=Add))+
geom_point(stat = "identity", position="dodge")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")
ggplot(EZ,aes(x = Temp, y = alpha))+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black", position="dodge")+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")
AlphaERROR = EZ %>%
group_by(Temp,Add) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
AlphaERROR = EZ %>%
group_by(Temp,Add) %>%
summarize(mean_value = mean(alpha, na.rm = TRUE),
se = sqrt(var(alpha, na.rm = TRUE) / sum(!is.na(alpha)))) %>%
ungroup()
View(AlphaERROR)
View(EZ2)
View(EZ2)
View(EZ2)
EZalpha<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
View(EZalpha)
AlphaERROR = EZalpha %>%
filter(variable=alpha)
AlphaERROR = EZalpha %>%
filter(variable= 'alpha')
AlphaERROR = EZalpha %>%
filter(variable== "alpha") %>%
group_by(Temp,Add) %>%
summarize(mean_value = mean(alpha, na.rm = TRUE),
se = sqrt(var(alpha, na.rm = TRUE) / sum(!is.na(alpha)))) %>%
ungroup()
EZA = EZalpha %>%
filter(variable== "alpha")
View(EZA)
AlphaERROR = EZA %>%
group_by(Temp,Add) %>%
summarize(mean_value = mean(alpha, na.rm = TRUE),
se = sqrt(var(alpha, na.rm = TRUE) / sum(!is.na(alpha)))) %>%
ungroup()
AlphaERROR = EZA %>%
group_by(Temp,Add) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
View(AlphaERROR)
View(AlphaERROR)
View(EZalpha)
ggplot(EZ,aes(x = Temp, y = alpha))+
stat_summary(geom="bar")+
stat_summary(geom='errorbar')+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")
ggplot(EZ,aes(x = Temp, y = alpha, color=Temp))+
stat_summary(geom="bar")+
stat_summary(geom='errorbar')+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")
ggplot(EZ,aes(x = Temp, y = alpha, fill=Temp))+
stat_summary(geom="bar")+
stat_summary(geom='errorbar')+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")
ggplot(EZ,aes(x = Temp, y = alpha, fill=Temp))+
stat_summary(geom="bar")+
stat_summary(geom='errorbar')+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")+
theme_CKM()
EZ = read.csv("Data/Enzyme.csv")
EZ$CN<-EZ$BG/(EZ$LAP+EZ$NAG)
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZ$alpha <- (EZ$EndoC+EZ$EndoX)/(EZ$EndoC+EZ$EndoX+EZ$BG+EZ$BX)
EZ$alpha1 <- (EZ$EndoC)/(EZ$EndoC+EZ$BG)
EZ$alpha2 <- (EZ$EndoX)/(EZ$EndoX+EZ$BX)
EZ$Temp[EZ$Temp=="4"]<-"Pre"
EZ$Temp<- factor(EZ$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZalpha<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZA = EZalpha %>%
filter(variable== "alpha", variable=='alpha1', variable=='alpha2')
AlphaERROR = EZA %>%
group_by(Temp,Add) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
View(AlphaERROR)
View(EZalpha)
EZA = EZalpha %>%
filter(variable== "alpha", variable=="alpha1", variable=="alpha2")
## Temperature sensativity
EZA = EZalpha %>%
filter(variable== "alpha")
## Temperature sensativity
EZA = EZalpha %>%
filter(variable== "alpha1")
AlphaERROR = EZA %>%
group_by(Temp,Add) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZ,aes(x = Temp, y = alpha1, fill=Temp))+
stat_summary(geom="bar")+
stat_summary(geom='errorbar')+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha1")+
theme_CKM()
ggplot(EZ,aes(x = Temp, y = alpha2, fill=Temp))+
stat_summary(geom="bar")+
stat_summary(geom='errorbar')+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha2")+
theme_CKM()
EZ = read.csv("Data/Enzyme.csv")
View(EZ)
EZ$EndoC <- EZ$EndoC * 50  #current units are in per mL. making more comparable to other enzymes.
View(EZ)
EZ$EndoX <- EZ$EndoX * 50  #current units are in per mL. making more comparable to other enzymes.
EZ = read.csv("Data/Enzyme.csv")
EZ$EndoC <- EZ$EndoC * 50  #current units are in per mL. making more comparable to other enzymes.
EZ$EndoX <- EZ$EndoX * 50  #current units are in per mL. making more comparable to other enzymes.
EZ$CN<-EZ$BG/(EZ$LAP+EZ$NAG)
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
source("code/0-packages.R")
EZ = read.csv("Data/Enzyme.csv")
EZ$EndoC <- EZ$EndoC * 50  #current units are in per mL. making more comparable to other enzymes.
EZ$EndoX <- EZ$EndoX * 50  #current units are in per mL. making more comparable to other enzymes.
EZ$CN<-EZ$BG/(EZ$LAP+EZ$NAG)
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZ$alpha <- (EZ$EndoC+EZ$EndoX)/(EZ$EndoC+EZ$EndoX+EZ$BG+EZ$BX)
EZ$alpha1 <- (EZ$EndoC)/(EZ$EndoC+EZ$BG)
EZ$alpha2 <- (EZ$EndoX)/(EZ$EndoX+EZ$BX)
EZ$Temp[EZ$Temp=="4"]<-"Pre"
EZ$Temp<- factor(EZ$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZalpha<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZERROR2 = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZERROR2,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_CKM()
EZCARBON = EZERROR2 %>%
filter(variable== "BG" | variable== "BX" |variable== "EndoC" |variable== "EndoX")
EZERROR2
View(EZERROR2)
detach("package:dplyr", unload = TRUE)
library(dplyr)
##### Without additions
EZERROR2 = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
View(EZERROR2)
EZCARBON = EZERROR2 %>%
filter(variable== "BG" | variable== "BX" |variable== "EndoC" |variable== "EndoX")
View(EZCARBON)
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_CKM()
EZA = EZalpha %>%
filter(variable== "alpha1")
AlphaERROR = EZA %>%
group_by(Temp,Add) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZ,aes(x = Temp, y = alpha, fill=Temp))+
stat_summary(geom="bar")+
stat_summary(geom='errorbar')+
#facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("alpha")+
theme_CKM()
View(EZalpha)
EZCARBON5 = EZERROR2 %>%
filter(variable== "BG" | variable== "BX")
ggplot(EZCARBON5,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_CKM()
EZCARBON6 = EZERROR2 %>%
filter(variable== "EndoC" |variable== "EndoX")
ggplot(EZCARBON6,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_CKM()
