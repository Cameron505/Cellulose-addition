plot.title = element_text(hjust = 0, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity")+
theme_kp()+
ggsave("Graphs/Carbon_Enzymes.png")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity")+
theme_kp()+
ggsave("Graphs/Carbon_Enzymes.png")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity")+
theme_kp()
ggsave("Graphs/Carbon_Enzymes.png")
EZNUT = EZERROR %>%
filter(variable== "LAP" | variable== "NAG" |variable== "PHOS" |variable== "AFS")
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_kp()
ggsave("Graphs/NUT_MISC_Enzymes.png")
source("code/0-packages.R")
# source the functions
source("code/fticrrr/b-functions_analysis.R")
fticr_meta  = read.csv("data/processed/fticr_polar_meta.csv")
source("code/0-packages.R")
EZ = read.csv("Data/Enzyme.csv")
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZERROR,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_kp()
View(EZ)
EZ %>% dplyr::select(BG:EndoX)
## Stats
permanova_Enzymes =
adonis(EZ %>% dplyr::select(BG:EndoX)~ Add * Temp , data = EZ)
permanova_Enzymes
## Stats
permanova_EnzymeBG =
adonis(EZ %>% dplyr::select(BG)~ Add * Temp , data = EZ)
permanova_EnzymeBG
ANOVBG =
adonis(EZ %>% dplyr::select(BG)~ Add * Temp , data = EZ)
ANOVBX =
adonis(EZ %>% dplyr::select(BX)~ Add * Temp , data = EZ)
ANOVENDC =
adonis(EZ %>% dplyr::select(EndoC)~ Add * Temp , data = EZ)
ANOVENDX =
adonis(EZ %>% dplyr::select(EndoX)~ Add * Temp , data = EZ)
ANOVLAP =
adonis(EZ %>% dplyr::select(LAP)~ Add * Temp , data = EZ)
ANOVCBH =
adonis(EZ %>% dplyr::select(CBH)~ Add * Temp , data = EZ)
ANOVNAG =
adonis(EZ %>% dplyr::select(NAG)~ Add * Temp , data = EZ)
ANOVPHOS =
adonis(EZ %>% dplyr::select(PHOS)~ Add * Temp , data = EZ)
EZ
EZ<- EZ %>%
mutate_if(is.numeric, ~0.0001 * (. <=0))
EZ
EZ = read.csv("Data/Enzyme.csv")
EZ<- EZ %>%
mutate_if(is.numeric, ~0.1 * (. <=0))
EZ
EZ<- EZ %>%
mutate_if(is.numeric, ~0.1 * (. =<0))
EZ<- EZ %>%
mutate_if(is.numeric, ~0.1 * (. =0)) %>%
mutate_if(is.numeric, ~0.1 * (. < 0))
EZ
EZ = read.csv("Data/Enzyme.csv")
EZ
EZ<- EZ %>%
mutate_if(is.numeric, ~0.1 * (. =0)) %>%
mutate_if(is.numeric, ~0.1 * (. < 0))
EZ
EZ = read.csv("Data/Enzyme.csv")
EZ
EZ2<- EZ %>%
mutate_if(is.numeric, ~0.1 * (. < 0))
EZ2
EZ2<- EZ %>%
mutate_if(is.numeric, ~0.1 * (. > 0))
EZ2
EZ2<- EZ %>%
mutate_if(is.numeric, ~0.1 * (. = 0))
EZ2
EZ
EZ
EZ2<- EZ %>%
mutate_if(is.numeric, ~0.1 * (. <0))
EZ2
EZ2<- EZ %>%
mutate_if( ~0.1 * (. <0))
EZ %>% dplyr::select(BG:EndoX)
EZ2<-ifelse(EZ %>% dplyr::select(BG:EndoX)<0,0.1,EZ %>% dplyr::select(BG:EndoX))
EZ2
View(EZ2)
EZ
EZ[EZ < 0]
EZ[EZ < 0] <- 0.1
EZ
View(EZ)
EZ[EZ = 0] <- 0.1
EZ
## Stats
ANOVBG =
adonis(EZ %>% dplyr::select(BG)~ Add * Temp , data = EZ)
ANOVBX =
adonis(EZ %>% dplyr::select(BX)~ Add * Temp , data = EZ)
ANOVENDC =
adonis(EZ %>% dplyr::select(EndoC)~ Add * Temp , data = EZ)
ANOVENDX =
adonis(EZ %>% dplyr::select(EndoX)~ Add * Temp , data = EZ)
ANOVLAP =
adonis(EZ %>% dplyr::select(LAP)~ Add * Temp , data = EZ)
ANOVCBH =
adonis(EZ %>% dplyr::select(CBH)~ Add * Temp , data = EZ)
ANOVNAG =
adonis(EZ %>% dplyr::select(NAG)~ Add * Temp , data = EZ)
ANOVPHOS =
adonis(EZ %>% dplyr::select(PHOS)~ Add * Temp , data = EZ)
ANOVBG
ANOVBX
ANOVENDC
ANOVENDX
ANOVCBH
ANOVAFS
ANOVAFS =
adonis(EZ %>% dplyr::select(AFS)~ Add * Temp , data = EZ)
ANOVAFS
ANOVLAP
ANOVNAG
ANOVPHOS
devtools::install_github("kassambara/ggpubr")
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
EZ = read.csv("Data/Enzyme.csv")
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
EZCARBON = EZERROR %>%
filter(variable== "BG" | variable== "BX" |variable== "EndoC" |variable== "EndoX")
EZERROR
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
EZ2
View(EZ2)
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
detach("package:dplyr", unload = TRUE)
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
library(dplyr)
detach("package:dplyr", unload = TRUE)
detach("package:tidyverse", unload = TRUE)
library(tidyverse)
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
EZCARBON = EZERROR %>%
filter(variable== "BG" | variable== "BX" |variable== "EndoC" |variable== "EndoX")
EZNUT = EZERROR %>%
filter(variable== "LAP" | variable== "NAG" |variable== "PHOS" |variable== "AFS")
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
install.packages("ggpubr")
library(ggpubr)
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "t.test")+
theme_kp()
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "lm")+
theme_kp()
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
ggplot(EZNUT,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova", label.y = 40)+
theme_kp()
EZNUT
View(EZ2)
View(EZ2)
ggplot(EZ2,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means()+
theme_kp()
ggplot(EZ2,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means()+
theme_kp()
ggplot(EZ2,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
#stat_compare_means()+
theme_kp()
View(EZ2)
ggplot(EZ2,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
ggplot(EZ2,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
#stat_compare_means(method = "anova")+
theme_kp()
ggplot(EZ2,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")
ggplot(EZ2,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")
ggplot(EZ2,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
View(EZ2)
EZ3 <- EZ2 %>%
filter(variable== "LAP" | variable== "NAG" |variable== "PHOS" |variable== "AFS")
ggplot(EZ2,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
ggplot(EZ3,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
ggplot(EZ3,aes(x = Temp, y = value, fill=Temp))+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
ggplot(EZ3,aes(x = Temp, y = value, fill=Temp))+
stat_summary(geom = "bar")+
stat_summary(geom="errorbar")
ggplot(EZ3,aes(x = Temp, y = value, fill=Temp))+
stat_summary(geom = "bar")+
stat_summary(geom="errorbar")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova")+
theme_kp()
ggplot(EZ3,aes(x = Temp, y = value, fill=Temp))+
stat_summary(geom = "bar")+
stat_summary(geom="errorbar")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova", label.y = 40)+
theme_kp()
ggplot(EZ3,aes(x = Temp, y = value, fill=Temp))+
stat_summary(geom = "bar")+
stat_summary(geom="errorbar")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova", label.y = c(140,1000,200,1200))+
theme_kp()
ggplot(EZ3,aes(x = Temp, y = value, fill=Temp))+
stat_summary(geom = "bar")+
stat_summary(geom="errorbar")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
stat_compare_means(method = "anova",label = "p.signif",  label.y = c(140,1000,200,1200))+
theme_kp()
View(EZ)
EZ %>% dplyr::select(EndoC:EndoX)
EZ %>% dplyr::select(EndoC:EndoX)
EZ = read.csv("Data/Enzyme.csv")
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZERROR,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_kp()
ggsave("Graphs/Cellulose_Enzymes.png", device= "png")
EZCARBON = EZERROR %>%
filter(variable== "BG" | variable== "BX" |variable== "EndoC" |variable== "EndoX")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity")+
theme_kp()
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_kp()
ggsave("Graphs/Carbon_Enzymes.png")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_kp()
ggsave("Graphs/Carbon_Enzymes.png")
ggsave("Graphs/Carbon_Enzymes.png")
ggsave("Graphs/Carbon_Enzymes.png")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity")+
theme_kp()
ggsave("Graphs/Carbon_Enzymes.png")
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity ")+
theme_kp()
ggsave("Graphs/Carbon_Enzymes.png")
# custom ggplot theme
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
theme_kp <- function() {  # this for all the elements common across plots
theme_bw() %+replace%
theme(legend.position = "none",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
legend.background = element_rect(colour = NA),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity ")+
theme_kp()
ggplot(EZCARBON,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_kp()
ggsave("Graphs/Carbon_Enzymes.png")
source("code/0-packages.R")
EZ = read.csv("Data/Enzyme.csv")
EZ2<- melt(EZ, id.vars=c("ID","Date","Add","Temp"))
EZ2$Temp[EZ2$Temp=="4"]<-"Pre"
EZ2$Temp<- factor(EZ2$Temp, levels= c("-6","-2","2","6","10","Pre"))
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
ggplot(EZERROR,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 1, width = 1, color="black")+
facet_wrap(~ variable, ncol = 3,scales = "free")+
scale_fill_manual(values=cbPalette)+
theme_kp()
EZCBH = EZERROR %>%
filter(variable== "CBH")
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
EZCBH = EZERROR %>%
filter(variable== "CBH")
View(EZERROR)
detach("package:dplyr", unload = TRUE)
detach("package:tidyverse", unload = TRUE)
library(tidyverse)
EZERROR = EZ2 %>%
group_by(Temp, variable) %>%
summarize(mean_value = mean(value, na.rm = TRUE),
se = sqrt(var(value, na.rm = TRUE) / sum(!is.na(value)))) %>%
ungroup()
EZCBH = EZERROR %>%
filter(variable== "CBH")
ggplot(EZCBH,aes(x = Temp, y = mean_value, fill=Temp))+
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = mean_value - se, ymax = mean_value + se), lwd = 0.8, width = 0.7, color="black")+
facet_wrap(~ variable, ncol = 2,scales = "free")+
scale_fill_manual(values=cbPalette)+
ylab("Enzyme activity per g dry soil")+
theme_kp()
ggsave("Graphs/CBH_Enzymes.png")
